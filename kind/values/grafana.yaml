adminPassword: "Mikroways123"

ingress:
  enabled: true
  ingressClassName: nginx
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts:
    - grafana.127.0.0.1.nip.io
  path: /

datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
      - name: Prometheus
        type: prometheus
        uid: Prometheus
        # Service URL for prometheus server (from prometheus-community chart)
        url: http://prometheus-server.monitoring.svc.cluster.local
        access: proxy
        isDefault: true
        jsonData:
          # This enables the jump from Metrics to Traces (Exemplars)
          exemplarTraceIdDestinations:
            - name: trace_id
              datasourceUid: Tempo # Must match the Tempo UID below

      - name: Loki
        type: loki
        uid: Loki
        url: http://loki-gateway.monitoring.svc.cluster.local:80
        access: proxy
        jsonData:
          derivedFields:
            - datasourceUid: Tempo
              name: TraceID
              matcherType: label
              matcherRegex: trace_id
              url: '$${__value.raw}'

      - name: Tempo
        type: tempo
        uid: Tempo
        url: http://tempo.monitoring.svc.cluster.local:3200
        access: proxy
        jsonData:
          nodeGraph:
            enabled: true
          tracesToLogs:
            datasourceUid: Loki
            filterByTraceID: true
            filterBySpanID: true
            spanStartTimeShift: '-5m'
            spanEndTimeShift: '5m'
          tracesToMetrics:
            datasourceUid: Prometheus
            spanStartTimeShift: '-5m'
            spanEndTimeShift: '5m'
            tags:
              - key: service.name
                value: service_name
          lokiSearch:
            datasourceUid: Loki
          serviceMap:
            datasourceUid: Prometheus

sidecar:
  dashboards:
    enabled: true
    label: grafana_dashboard
    folder: /tmp/dashboards
    provider:
      allowUiUpdates: true
