apiVersion: v1
kind: ConfigMap
metadata:
  name: tracing-dashboard
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
data:
  tracing.json: |
   {
     "annotations": {
       "list": [
         {
           "builtIn": 1,
           "datasource": {
             "type": "grafana",
             "uid": "-- Grafana --"
           },
           "enable": true,
           "hide": true,
           "iconColor": "rgba(0, 211, 255, 1)",
           "name": "Annotations & Alerts",
           "type": "dashboard"
         }
       ]
     },
     "editable": true,
     "fiscalYearStartMonth": 0,
     "graphTooltip": 0,
     "id": null,
     "links": [],
     "liveNow": false,
     "panels": [
       {
         "content": "# Distributed Tracing\n\nView tracing telemetry stored in **Tempo**.\n\nServices monitored:\n* **orders-service**\n* **products-service**\n\nUse the panels below to identify **Errors** (500s) and **High Latency** events.",
         "gridPos": {
           "h": 4,
           "w": 24,
           "x": 0,
           "y": 0
         },
         "id": 1,
         "options": {
           "code": {
             "language": "markdown",
             "showLineNumbers": false,
             "showMiniMap": false
           },
           "content": "<div class=\"markdown-html\"><h1>üöÄ Distributed Tracing PoC</h1>\n<p>This dashboard provides a high-level view of the tracing telemetry stored in <strong>Tempo</strong>.</p>\n<p>It is focused on two main services:</p>\n<ul>\n<li><strong>orders-service</strong></li>\n<li><strong>products-service</strong></li>\n</ul>\n<p>Use the panels below to quickly identify <strong>Errors</strong> (500s) and <strong>High Latency</strong> events.</p>\n</div>",
           "mode": "markdown"
         },
         "pluginVersion": "10.0.0",
         "title": "Welcome",
         "type": "text"
       },
       {
         "collapsed": false,
         "gridPos": {
           "h": 1,
           "w": 24,
           "x": 0,
           "y": 4
         },
         "id": 2,
         "panels": [],
         "title": "üì¶ Service: orders-service",
         "type": "row"
       },
       {
         "datasource": {
           "type": "tempo",
           "uid": "${datasource}"
         },
         "description": "Shows traces for 'orders-service' that have an error status or HTTP 500 code.",
         "gridPos": {
           "h": 9,
           "w": 12,
           "x": 0,
           "y": 5
         },
         "id": 3,
         "options": {
           "cellHeight": "sm",
           "footer": {
             "countRows": false,
             "fields": "",
             "reducer": [
               "sum"
             ],
             "show": false
           },
           "showHeader": true,
           "sortBy": [
             {
               "desc": true,
               "displayName": "Start time"
             }
           ]
         },
         "pluginVersion": "10.0.0",
         "targets": [
           {
             "datasource": {
               "type": "tempo",
               "uid": "${datasource}"
             },
             "query": "{ resource.service.name = \"orders-service\" && (status = error || span.http.status_code >= 500) }",
             "queryType": "traceql",
             "refId": "A"
           }
         ],
         "title": "üö® Recent Errors (Orders)",
         "type": "table"
       },
       {
         "datasource": {
           "type": "tempo",
           "uid": "${datasource}"
         },
         "description": "Shows traces for 'orders-service' that took longer than 500ms.",
         "gridPos": {
           "h": 9,
           "w": 12,
           "x": 12,
           "y": 5
         },
         "id": 4,
         "options": {
           "cellHeight": "sm",
           "footer": {
             "countRows": false,
             "fields": "",
             "reducer": [
               "sum"
             ],
             "show": false
           },
           "showHeader": true,
           "sortBy": [
             {
               "desc": true,
               "displayName": "Duration"
             }
           ]
         },
         "pluginVersion": "10.0.0",
         "targets": [
           {
             "datasource": {
               "type": "tempo",
               "uid": "${datasource}"
             },
             "query": "{ resource.service.name = \"orders-service\" && duration > 500ms }",
             "queryType": "traceql",
             "refId": "A"
           }
         ],
         "title": "üê¢ Slow Traces > 500ms (Orders)",
         "type": "table"
       },
       {
         "collapsed": false,
         "gridPos": {
           "h": 1,
           "w": 24,
           "x": 0,
           "y": 14
         },
         "id": 5,
         "panels": [],
         "title": "üõí Service: products-service",
         "type": "row"
       },
       {
         "datasource": {
           "type": "tempo",
           "uid": "${datasource}"
         },
         "description": "Shows traces for 'products-service' that have an error status or HTTP 500 code.",
         "gridPos": {
           "h": 9,
           "w": 12,
           "x": 0,
           "y": 15
         },
         "id": 6,
         "options": {
           "cellHeight": "sm",
           "footer": {
             "countRows": false,
             "fields": "",
             "reducer": [
               "sum"
             ],
             "show": false
           },
           "showHeader": true,
           "sortBy": [
             {
               "desc": true,
               "displayName": "Start time"
             }
           ]
         },
         "pluginVersion": "10.0.0",
         "targets": [
           {
             "datasource": {
               "type": "tempo",
               "uid": "${datasource}"
             },
             "query": "{ resource.service.name = \"products-service\" && (status = error || span.http.status_code >= 500) }",
             "queryType": "traceql",
             "refId": "A"
           }
         ],
         "title": "üö® Recent Errors (Products)",
         "type": "table"
       },
       {
         "datasource": {
           "type": "tempo",
           "uid": "${datasource}"
         },
         "description": "Shows traces for 'products-service' that took longer than 500ms.",
         "gridPos": {
           "h": 9,
           "w": 12,
           "x": 12,
           "y": 15
         },
         "id": 7,
         "options": {
           "cellHeight": "sm",
           "footer": {
             "countRows": false,
             "fields": "",
             "reducer": [
               "sum"
             ],
             "show": false
           },
           "showHeader": true,
           "sortBy": [
             {
               "desc": true,
               "displayName": "Duration"
             }
           ]
         },
         "pluginVersion": "10.0.0",
         "targets": [
           {
             "datasource": {
               "type": "tempo",
               "uid": "${datasource}"
             },
             "query": "{ resource.service.name = \"products-service\" && duration > 500ms }",
             "queryType": "traceql",
             "refId": "A"
           }
         ],
         "title": "üê¢ Slow Traces > 500ms (Products)",
         "type": "table"
       },
       {
         "collapsed": false,
         "gridPos": {
           "h": 1,
           "w": 24,
           "x": 0,
           "y": 24
         },
         "id": 8,
         "panels": [],
         "title": "üîç Advanced Explorer",
         "type": "row"
       },
       {
         "datasource": {
           "type": "tempo",
           "uid": "${datasource}"
         },
         "description": "Explore all traces without predefined filters.",
         "gridPos": {
           "h": 10,
           "w": 24,
           "x": 0,
           "y": 25
         },
         "id": 9,
         "options": {
           "cellHeight": "sm",
           "footer": {
             "countRows": false,
             "fields": "",
             "reducer": [
               "sum"
             ],
             "show": false
           },
           "showHeader": true,
           "sortBy": [
             {
               "desc": true,
               "displayName": "Start time"
             }
           ]
         },
         "pluginVersion": "10.0.0",
         "targets": [
           {
             "datasource": {
               "type": "tempo",
               "uid": "${datasource}"
             },
             "query": "{ }",
             "queryType": "traceql",
             "refId": "A"
           }
         ],
         "title": "All Traces Explorer",
         "type": "table"
       }
     ],
     "schemaVersion": 38,
     "style": "dark",
     "tags": [
       "tempo",
       "traces"
     ],
     "templating": {
       "list": [
         {
           "current": {
             "selected": false,
             "text": "Tempo",
             "value": "Tempo"
           },
           "hide": 0,
           "includeAll": false,
           "label": "Datasource",
           "multi": false,
           "name": "datasource",
           "options": [],
           "query": "tempo",
           "refresh": 1,
           "regex": "",
           "skipUrlSync": false,
           "type": "datasource"
         }
       ]
     },
     "time": {
       "from": "now-1h",
       "to": "now"
     },
     "timepicker": {},
     "timezone": "",
     "title": "Distributed Tracing",
     "uid": "super-traces-poc-v1",
     "version": 1,
     "weekStart": ""
   }

   